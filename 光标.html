<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title></title>
	<link rel="stylesheet" type="text/css" href="bower_components/bootstrap/dist/css/bootstrap.min.css">
	<script type="text/javascript" src="jquery-1.10.2.js"></script>
	<script type="text/javascript" src="file/ajaxfileupload.js"></script>
	<script type="text/javascript" src="file/fileupload.js"></script>
	<script type="text/javascript" src="file/jquery.upload.js"></script>
	<script type="text/javascript" src="file/local.file.js"></script>
	<script type="text/javascript" src="file/plugins.js"></script>
</head>
<body>
 <table>
 	<tbody>
 		<tr>
      	  <td class="tb-title" >附件<span class="bitian">*</span></td>
				<td colspan="6">
						<input type="text" id="content0" class="form-control input_bi"  name="enclosure[]" >
						<input type="text" id="post-content0" class="form-control input_bi" value="3" >
						<span class="help-block red"></span>
						<span class="pull-right btn_wrap">
							 <input type="type" value="上传附件" >
						</span>					 
				</td>
		</tr>     
 	</tbody>
 </table>
</body>
</html>

<script>
		var i = 1; //计数变量
		// 触发事件
		$('#content0').keyup(function(){
			if (i == 1) {
				count(this,10);
			}else{
				var hisVal = $(this).val();
				$(this).val(hisVal);
			}
			var valLen = $(this).val().length - 1;
			// console.log(valLen);
			setCaretPosition(this,valLen);
			i++;
		});
		$('#content0').click(function(){
			var CaretPos = getCursortPosition(this);//获取光标位置
			var valLen = $(this).val().length;//输入框字符长度
			console.log(valLen);
			console.log(CaretPos);
			if (CaretPos == valLen) {
				setCaretPosition(this,valLen - 1);
			}
		});
		// 改变input值函数
		function count(ele,price){
			// var num = parseInt($(ele).val());
			var num = Number($(ele).val());
			countprice = num*price;
			// console.log(countprice);
			$(ele).val(countprice);
			$(ele).siblings('#post-content0').attr('value',countprice);
		}
		// 设置光标位置函数
		function setCaretPosition(ctrl, pos){
		    if(ctrl.setSelectionRange)
		    {
		        ctrl.focus();
		        ctrl.setSelectionRange(pos,pos);
		    }
		    else if (ctrl.createTextRange) {
		        var range = ctrl.createTextRange();
		        range.collapse(true);
		        range.moveEnd('character', pos);
		        range.moveStart('character', pos);
		        range.select();
		    }
		}

		// 获取光标位置函数
		function getCursortPosition (ctrl) {
		  var CaretPos = 0;  // IE Support
		  if (document.selection) {
		  ctrl.focus ();
		    var Sel = document.selection.createRange ();
		    Sel.moveStart ('character', -ctrl.value.length);
		    CaretPos = Sel.text.length;
		  }
		  // Firefox support
		  else if (ctrl.selectionStart || ctrl.selectionStart == '0')
		    CaretPos = ctrl.selectionStart;
		  return (CaretPos);
		}

		// IE
		function getCursortPosition (ctrl) {
		    var CaretPos = 0;   // IE Support
		    if (document.selection) {
		    ctrl.focus ();
		        var Sel = document.selection.createRange ();
		        Sel.moveStart ('character', -ctrl.value.length);
		        CaretPos = Sel.text.length;
		    }
		    // Firefox support
		    else if (ctrl.selectionStart || ctrl.selectionStart == '0')
		        CaretPos = ctrl.selectionStart;
		    return (CaretPos);
		}

</script>